const t=new class{constructor(t){this.initialState=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.state=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="idle"}getEmptyCells(){let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push({row:e,col:s});return t}addRandomNumber(){let t=this.getEmptyCells();if(0===t.length)return;let e=Math.floor(Math.random()*t.length),s=t[e];this.state[s.row][s.col]=.9>Math.random()?2:4}gamePossible(){for(let t=0;t<this.state.length;t++)for(let e=0;e<this.state[t].length;e++)if(0===this.state[t][e])return!0;for(let t=0;t<this.state.length;t++)for(let e=0;e<this.state[t].length-1;e++)if(this.state[t][e]===this.state[t][e+1])return!0;for(let t=0;t<this.state[0].length;t++)for(let e=0;e<this.state.length-1;e++)if(this.state[e][t]===this.state[e+1][t])return!0;return!1}moveLeft(){if("playing"!==this.status)return;let t=JSON.stringify(this.state);for(let t=0;t<this.state.length;t++){let e=this.state[t].filter(t=>0!==t);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e[t+1]=0,this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<4;)e.push(0);this.state[t]=e}t!==JSON.stringify(this.state)&&this.addRandomNumber()}moveRight(){if("playing"!==this.status)return;let t=JSON.stringify(this.state);for(let t=0;t<this.state.length;t++){let e=this.state[t].filter(t=>0!==t);for(let t=e.length-1;t>0;t--)e[t]===e[t-1]&&(e[t]*=2,e[t-1]=0,this.score+=e[t]);for(e=e.filter(t=>0!==t);e.length<4;)e.unshift(0);this.state[t]=e}t!==JSON.stringify(this.state)&&this.addRandomNumber()}moveUp(){if("playing"!==this.status)return;let t=JSON.stringify(this.state);for(let t=0;t<this.state[0].length;t++){let e=[];for(let s=0;s<this.state.length;s++)e.push(this.state[s][t]);let s=e.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,s[t+1]=0,this.score+=s[t]);for(s=s.filter(t=>0!==t);s.length<4;)s.push(0);for(let e=0;e<this.state.length;e++)this.state[e][t]=s[e]}t!==JSON.stringify(this.state)&&this.addRandomNumber()}moveDown(){if("playing"!==this.status)return;let t=JSON.stringify(this.state);for(let t=0;t<this.state[0].length;t++){let e=[];for(let s=0;s<this.state.length;s++)e.push(this.state[s][t]);let s=e.filter(t=>0!==t);for(let t=s.length-1;t>0;t--)s[t]===s[t-1]&&(s[t]*=2,s[t-1]=0,this.score+=s[t]);for(s=s.filter(t=>0!==t);s.length<4;)s.unshift(0);for(let e=0;e<this.state.length;e++)this.state[e][t]=s[e]}t!==JSON.stringify(this.state)&&this.addRandomNumber()}getScore(){return this.score}getState(){return this.state}getStatus(){for(let t=0;t<this.state.length;t++)for(let e=0;e<this.state[t].length;e++)if(2048===this.state[t][e])return this.status="win",this.status;return this.gamePossible()||(this.status="lose"),this.status}start(){this.state=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="playing",this.addRandomNumber(),this.addRandomNumber()}restart(){this.state=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="idle"}},e={IDLE:"idle",WIN:"win",LOSE:"lose"},s=document.querySelector(".button.start"),i=document.querySelector(".game-score"),r=document.querySelector(".message-start"),a=document.querySelector(".message-win"),l=document.querySelector(".message-lose");function h(){document.querySelectorAll(".field-row").forEach((e,s)=>{e.querySelectorAll(".field-cell").forEach((e,i)=>{let r=t.state[s][i];e.className="field-cell",0!==r?(e.classList.add(`field-cell--${r}`),e.textContent=r):e.textContent=""})})}s.addEventListener("click",()=>{t.status===e.IDLE?(t.start(),i.textContent=t.score,s.textContent="Restart",s.classList.replace("start","restart"),r.classList.add("hidden")):(t.restart(),i.textContent="0",s.textContent="Start",s.classList.replace("restart","start"),r.classList.remove("hidden"),a.classList.add("hidden"),l.classList.add("hidden")),h()}),document.addEventListener("keydown",s=>{if(s.preventDefault(),t.status!==e.IDLE&&t.status!==e.WIN&&t.status!==e.LOSE){switch(s.key){case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight()}t.getStatus(),t.status===e.WIN?a.classList.remove("hidden"):t.status===e.LOSE&&l.classList.remove("hidden"),i.textContent=t.score,h()}});
//# sourceMappingURL=index.e8f11102.js.map
