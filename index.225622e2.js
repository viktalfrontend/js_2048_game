!function(){function t(t,e){for(var s=0;s<e.length;s++){var a=e[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var e=new(function(){var e,s;function a(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),this.initialState=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.state=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="idle"}return e=[{key:"getEmptyCells",value:function(){for(var t=[],e=0;e<this.state.length;e++)for(var s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push({row:e,col:s});return t}},{key:"addRandomNumber",value:function(){var t=this.getEmptyCells();if(0!==t.length){var e=Math.floor(Math.random()*t.length),s=t[e];this.state[s.row][s.col]=.9>Math.random()?2:4}}},{key:"gamePossible",value:function(){for(var t=0;t<this.state.length;t++)for(var e=0;e<this.state[t].length;e++)if(0===this.state[t][e])return!0;for(var s=0;s<this.state.length;s++)for(var a=0;a<this.state[s].length-1;a++)if(this.state[s][a]===this.state[s][a+1])return!0;for(var r=0;r<this.state[0].length;r++)for(var i=0;i<this.state.length-1;i++)if(this.state[i][r]===this.state[i+1][r])return!0;return!1}},{key:"moveLeft",value:function(){var t=this;if("playing"===this.status){for(var e=JSON.stringify(this.state),s=0;s<this.state.length;s++)!function(e){for(var s=t.state[e].filter(function(t){return 0!==t}),a=0;a<s.length-1;a++)s[a]===s[a+1]&&(s[a]*=2,s[a+1]=0,t.score+=s[a]);for(s=s.filter(function(t){return 0!==t});s.length<4;)s.push(0);t.state[e]=s}(s);e!==JSON.stringify(this.state)&&this.addRandomNumber()}}},{key:"moveRight",value:function(){var t=this;if("playing"===this.status){for(var e=JSON.stringify(this.state),s=0;s<this.state.length;s++)!function(e){for(var s=t.state[e].filter(function(t){return 0!==t}),a=s.length-1;a>0;a--)s[a]===s[a-1]&&(s[a]*=2,s[a-1]=0,t.score+=s[a]);for(s=s.filter(function(t){return 0!==t});s.length<4;)s.unshift(0);t.state[e]=s}(s);e!==JSON.stringify(this.state)&&this.addRandomNumber()}}},{key:"moveUp",value:function(){var t=this;if("playing"===this.status){for(var e=JSON.stringify(this.state),s=0;s<this.state[0].length;s++)!function(e){for(var s=[],a=0;a<t.state.length;a++)s.push(t.state[a][e]);for(var r=s.filter(function(t){return 0!==t}),i=0;i<r.length-1;i++)r[i]===r[i+1]&&(r[i]*=2,r[i+1]=0,t.score+=r[i]);for(r=r.filter(function(t){return 0!==t});r.length<4;)r.push(0);for(var n=0;n<t.state.length;n++)t.state[n][e]=r[n]}(s);e!==JSON.stringify(this.state)&&this.addRandomNumber()}}},{key:"moveDown",value:function(){var t=this;if("playing"===this.status){for(var e=JSON.stringify(this.state),s=0;s<this.state[0].length;s++)!function(e){for(var s=[],a=0;a<t.state.length;a++)s.push(t.state[a][e]);for(var r=s.filter(function(t){return 0!==t}),i=r.length-1;i>0;i--)r[i]===r[i-1]&&(r[i]*=2,r[i-1]=0,t.score+=r[i]);for(r=r.filter(function(t){return 0!==t});r.length<4;)r.unshift(0);for(var n=0;n<t.state.length;n++)t.state[n][e]=r[n]}(s);e!==JSON.stringify(this.state)&&this.addRandomNumber()}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state}},{key:"getStatus",value:function(){for(var t=0;t<this.state.length;t++)for(var e=0;e<this.state[t].length;e++)if(2048===this.state[t][e])return this.status="win",this.status;return this.gamePossible()||(this.status="lose"),this.status}},{key:"start",value:function(){this.state=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="playing",this.addRandomNumber(),this.addRandomNumber()}},{key:"restart",value:function(){this.state=JSON.parse(JSON.stringify(this.initialState)),this.score=0,this.status="idle"}}],t(a.prototype,e),s&&t(a,s),a}()),s={IDLE:"idle",WIN:"win",LOSE:"lose"},a=document.querySelector(".button.start"),r=document.querySelector(".game-score"),i=document.querySelector(".message-start"),n=document.querySelector(".message-win"),o=document.querySelector(".message-lose");function h(){document.querySelectorAll(".field-row").forEach(function(t,s){t.querySelectorAll(".field-cell").forEach(function(t,a){var r=e.state[s][a];t.className="field-cell",0!==r?(t.classList.add("field-cell--".concat(r)),t.textContent=r):t.textContent=""})})}a.addEventListener("click",function(){e.status===s.IDLE?(e.start(),r.textContent=e.score,a.textContent="Restart",a.classList.replace("start","restart"),i.classList.add("hidden")):(e.restart(),r.textContent="0",a.textContent="Start",a.classList.replace("restart","start"),i.classList.remove("hidden"),n.classList.add("hidden"),o.classList.add("hidden")),h()}),document.addEventListener("keydown",function(t){if(t.preventDefault(),e.status!==s.IDLE&&e.status!==s.WIN&&e.status!==s.LOSE){switch(t.key){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight()}e.getStatus(),e.status===s.WIN?n.classList.remove("hidden"):e.status===s.LOSE&&o.classList.remove("hidden"),r.textContent=e.score,h()}})}();
//# sourceMappingURL=index.225622e2.js.map
